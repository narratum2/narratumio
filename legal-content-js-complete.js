// Legal content for NYC-based company
const legalContent = {
    privacy: `
        <h2>Privacy Policy</h2>
        <p class="legal-date">Last Updated: January 2025</p>
        
        <h3>1. Introduction</h3>
        <p>Narratum LLC ("we," "our," or "us") respects your privacy and is committed to protecting your personal data. This privacy policy explains how we collect, use, and safeguard your information when you visit our website narratum.io.</p>
        
        <h3>2. Information We Collect</h3>
        <p>We may collect the following types of information:</p>
        <ul>
            <li><strong>Contact Information:</strong> Name, email address, company name when you submit our contact form</li>
            <li><strong>Usage Data:</strong> IP address, browser type, pages visited, time spent on pages</li>
            <li><strong>Cookies:</strong> Small data files stored on your device to improve your experience</li>
        </ul>
        
        <h3>3. How We Use Your Information</h3>
        <p>We use collected information to:</p>
        <ul>
            <li>Respond to your inquiries and provide requested services</li>
            <li>Improve our website and user experience</li>
            <li>Send periodic emails regarding our services (with your consent)</li>
            <li>Comply with legal obligations</li>
        </ul>
        
        <h3>4. Data Protection</h3>
        <p>We implement appropriate technical and organizational measures to protect your personal data against unauthorized access, alteration, disclosure, or destruction.</p>
        
        <h3>5. Third-Party Services</h3>
        <p>We may use third-party services for analytics (Google Analytics) that collect, monitor, and analyze usage data. These services have their own privacy policies.</p>
        
        <h3>6. Your Rights</h3>
        <p>Under applicable data protection laws, you have the right to:</p>
        <ul>
            <li>Access your personal data</li>
            <li>Correct inaccurate data</li>
            <li>Request deletion of your data</li>
            <li>Object to processing of your data</li>
            <li>Data portability</li>
        </ul>
        
        <h3>7. Contact Information</h3>
        <p>For any privacy-related questions or to exercise your rights, contact us at:</p>
        <p>
            Narratum LLC<br>
            110 East 25th Street<br>
            New York, NY 10010<br>
            Email: privacy@narratum.io
        </p>
        
        <h3>8. Changes to This Policy</h3>
        <p>We may update this privacy policy from time to time. We will notify you of any changes by posting the new policy on this page.</p>
    `,
    
    terms: `
        <h2>Terms of Service</h2>
        <p class="legal-date">Last Updated: January 2025</p>
        
        <h3>1. Agreement to Terms</h3>
        <p>By accessing and using narratum.io (the "Website"), you agree to be bound by these Terms of Service ("Terms"). If you disagree with any part of these terms, you may not access the Website.</p>
        
        <h3>2. Intellectual Property Rights</h3>
        <p>The Website and its original content, features, and functionality are owned by Narratum LLC and are protected by international copyright, trademark, patent, trade secret, and other intellectual property laws.</p>
        
        <h3>3. User Representations</h3>
        <p>By using our Website, you represent and warrant that:</p>
        <ul>
            <li>You have the legal capacity to enter into these Terms</li>
            <li>You will not use the Website for any illegal or unauthorized purpose</li>
            <li>Your use will not violate any applicable law or regulation</li>
        </ul>
        
        <h3>4. Prohibited Uses</h3>
        <p>You may not use our Website:</p>
        <ul>
            <li>To transmit any advertising or promotional material without our consent</li>
            <li>To impersonate any person or entity</li>
            <li>In any way that infringes upon the rights of others</li>
            <li>To engage in any conduct that restricts or inhibits anyone's use of the Website</li>
            <li>To introduce any viruses, trojan horses, or other harmful material</li>
        </ul>
        
        <h3>5. Disclaimer</h3>
        <p>The information on this Website is provided on an "as is" basis. We make no warranties, expressed or implied, and hereby disclaim all warranties including, without limitation, implied warranties of merchantability, fitness for a particular purpose, or non-infringement.</p>
        
        <h3>6. Limitation of Liability</h3>
        <p>In no event shall Narratum LLC, its directors, employees, partners, agents, suppliers, or affiliates be liable for any indirect, incidental, special, consequential, or punitive damages arising out of your use of the Website.</p>
        
        <h3>7. Indemnification</h3>
        <p>You agree to defend, indemnify, and hold harmless Narratum LLC from any claim or demand made by any third party due to your breach of these Terms or your violation of any law or rights of a third party.</p>
        
        <h3>8. Governing Law</h3>
        <p>These Terms shall be governed by and construed in accordance with the laws of the State of New York, without regard to its conflict of law provisions. Any legal action shall be brought exclusively in the courts located in New York County, New York.</p>
        
        <h3>9. Contact Information</h3>
        <p>Questions about these Terms should be sent to:</p>
        <p>
            Narratum LLC<br>
            110 East 25th Street<br>
            New York, NY 10010<br>
            Email: legal@narratum.io
        </p>
        
        <p class="legal-date">Effective Date: January 1, 2025</p>
        <p class="legal-date">Narratum LLC is a limited liability company organized under the laws of New York.</p>
    `,
    
    cookies: `
        <h2>Cookie Policy</h2>
        <p class="legal-date">Last Updated: January 2025</p>
        
        <h3>1. What Are Cookies</h3>
        <p>Cookies are small text files that are placed on your device when you visit our website. They help us provide you with a better experience and allow certain features to work.</p>
        
        <h3>2. How We Use Cookies</h3>
        <p>We use cookies for the following purposes:</p>
        <ul>
            <li><strong>Essential Cookies:</strong> Required for the website to function properly</li>
            <li><strong>Analytics Cookies:</strong> Help us understand how visitors interact with our website</li>
            <li><strong>Preference Cookies:</strong> Remember your settings and preferences</li>
        </ul>
        
        <h3>3. Types of Cookies We Use</h3>
        <table class="cookie-table">
            <thead>
                <tr>
                    <th>Cookie Name</th>
                    <th>Purpose</th>
                    <th>Duration</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>_ga</td>
                    <td>Google Analytics - tracks unique visitors</td>
                    <td>2 years</td>
                </tr>
                <tr>
                    <td>_gid</td>
                    <td>Google Analytics - tracks unique visitors</td>
                    <td>24 hours</td>
                </tr>
                <tr>
                    <td>narratum_consent</td>
                    <td>Stores cookie consent preference</td>
                    <td>1 year</td>
                </tr>
                <tr>
                    <td>narratum_theme</td>
                    <td>Stores color theme preference</td>
                    <td>1 year</td>
                </tr>
            </tbody>
        </table>
        
        <h3>4. Managing Cookies</h3>
        <p>You can control and manage cookies in various ways:</p>
        <ul>
            <li><strong>Browser Settings:</strong> Most browsers allow you to refuse or delete cookies</li>
            <li><strong>Our Cookie Settings:</strong> Use our cookie preference center below</li>
        </ul>
        
        <h3>5. Cookie Preferences</h3>
        <div class="cookie-preferences">
            <div class="cookie-option">
                <label>
                    <input type="checkbox" id="essential-cookies" checked disabled>
                    <span>Essential Cookies (Required)</span>
                </label>
                <p>These cookies are necessary for the website to function and cannot be disabled.</p>
            </div>
            <div class="cookie-option">
                <label>
                    <input type="checkbox" id="analytics-cookies" checked>
                    <span>Analytics Cookies</span>
                </label>
                <p>Help us understand how visitors interact with our website.</p>
            </div>
            <div class="cookie-option">
                <label>
                    <input type="checkbox" id="preference-cookies" checked>
                    <span>Preference Cookies</span>
                </label>
                <p>Remember your settings and preferences for a better experience.</p>
            </div>
            <button class="save-preferences" onclick="saveCookiePreferences()">Save Preferences</button>
        </div>
        
        <h3>6. Contact Us</h3>
        <p>If you have questions about our use of cookies, please contact us at:</p>
        <p>
            Narratum LLC<br>
            110 East 25th Street<br>
            New York, NY 10010<br>
            Email: privacy@narratum.io
        </p>
    `
};

// Cookie consent functions
function checkCookieConsent() {
    const consent = localStorage.getItem('narratum_consent');
    if (!consent) {
        document.getElementById('cookieBanner').style.display = 'block';
    }
}

function acceptCookies() {
    localStorage.setItem('narratum_consent', 'accepted');
    localStorage.setItem('narratum_consent_date', new Date().toISOString());
    document.getElementById('cookieBanner').style.display = 'none';
    
    // Initialize analytics if consented
    if (typeof gtag !== 'undefined') {
        gtag('consent', 'update', {
            'analytics_storage': 'granted'
        });
    }
}

function saveCookiePreferences() {
    const analytics = document.getElementById('analytics-cookies')?.checked;
    const preferences = document.getElementById('preference-cookies')?.checked;
    
    localStorage.setItem('narratum_consent', 'custom');
    localStorage.setItem('narratum_analytics', analytics);
    localStorage.setItem('narratum_preferences', preferences);
    localStorage.setItem('narratum_consent_date', new Date().toISOString());
    
    // Update analytics consent
    if (typeof gtag !== 'undefined') {
        gtag('consent', 'update', {
            'analytics_storage': analytics ? 'granted' : 'denied'
        });
    }
    
    alert('Cookie preferences saved successfully!');
    closeLegalModal();
}

// Modal functions
function openLegalModal(type) {
    const modal = document.getElementById('legalModal');
    const content = document.getElementById('modalContent');
    
    if (legalContent[type]) {
        content.innerHTML = legalContent[type];
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
        
        // Initialize cookie checkboxes if on cookie page
        if (type === 'cookies') {
            const analyticsConsent = localStorage.getItem('narratum_analytics') !== 'false';
            const preferencesConsent = localStorage.getItem('narratum_preferences') !== 'false';
            
            const analyticsCheckbox = document.getElementById('analytics-cookies');
            const preferencesCheckbox = document.getElementById('preference-cookies');
            
            if (analyticsCheckbox) analyticsCheckbox.checked = analyticsConsent;
            if (preferencesCheckbox) preferencesCheckbox.checked = preferencesConsent;
        }
    }
}

function closeLegalModal() {
    const modal = document.getElementById('legalModal');
    modal.style.display = 'none';
    document.body.style.overflow = '';
}

// Close modal on outside click
window.addEventListener('click', (e) => {
    const modal = document.getElementById('legalModal');
    if (e.target === modal) {
        closeLegalModal();
    }
});

// Lazy loading implementation
function initializeLazyLoading() {
    const lazyElements = document.querySelectorAll('.lazy-load, .capability-block, .journey-node, .partnership-category');
    
    const lazyLoadObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('loaded');
                
                // Add staggered animation for grid items
                if (entry.target.classList.contains('lazy-load')) {
                    const siblings = entry.target.parentElement.querySelectorAll('.lazy-load');
                    const index = Array.from(siblings).indexOf(entry.target);
                    entry.target.style.transitionDelay = `${index * 0.1}s`;
                }
                
                lazyLoadObserver.unobserve(entry.target);
            }
        });
    }, {
        rootMargin: '50px',
        threshold: 0.1
    });
    
    lazyElements.forEach(element => {
        element.classList.add('lazy-element');
        lazyLoadObserver.observe(element);
    });
}

// Initialize on DOM load
document.addEventListener('DOMContentLoaded', () => {
    checkCookieConsent();
    initializeLazyLoading();
});